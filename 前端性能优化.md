# 前端性能优化



## 资源的合并与压缩

### 理解减少http请求数量和减少请求资源大小两个优化要点

#### 浏览器的一个请求从发送都返回都经历了什么？

- dns是否可以通过缓存来减少dns查询时间

- 网络请求是否走最近的网络环境

- 相同的静态资源是否可以缓存（CDN, 或者本地）

- 能否减少http请求的大小

- 减少http请求的数量

- 服务端渲染

  **深入理解htttp请求的过程，是前端性能优化的核心**



### 掌握压缩和合并的原理

#### 资源的合并与压缩

1. 减少http请求数量
2. 减少http请求大小

#### google首页案例

- html压缩 ： 压缩在html解析中无用的空格，制表符，换行符和html注释等
- css压缩： 无效代码删除、 css语义合并
- js的压缩和混乱： 无效字符删除、剔除注释、 代码语义的缩减和优化、 代码保护
- 文件合并
- 开启gzip

#### 如何html压缩 *

1. 使用在线网站进行压缩（废弃： 不符合现代化前端构建工具方案）
2. node.js 提供的 **html-minifier**工具（可以构建工具做，可以node服务端做）
3. 后端模板引擎渲染压缩（例如ejs  等）

#### 如何css压缩 **

1. 使用在线网站进行压缩（废弃： 不符合现代化前端构建工具方案）
2. node.js 提供的 **html-minifier**工具对html中的css进行压缩 
3. 使用clean-css对css进行压缩

#### 如何JS压缩和混乱 ***

1. 使用在线网站进行压缩（废弃： 不符合现代化前端构建工具方案）
2. node.js 提供的 **html-minifier**工具对html中的js进行压缩 
3. 使用uglifyjs2对js进行压缩

以上这3种类压缩， 最好都是在构建工具就直接完成



#### 文件不合并的影响

- 文件与文件间有插入的上行请求，增加了N-1个网络延时
- 受丢包问题的影响更加严重
- 经过代理服务器可能会被断开

![](C:\mycode\project\doc\images\optimization\文件合并.png)



#### 文件合并存在的问题

- 首屏渲染问题 ： 合并后的js 过大，导致依赖的js迟迟无法加载，而阻塞渲染
- 缓存失效问题： 比如a.js、b.js、c.js  被合并成 d[hash].js, 那么对与a、b、c任意一个文件的修改，都会导致打包后的d[hash].js 文件名改变，从而使得缓存大面积失效。
- 解决办法： 
- 公共库合并：  公共库打包在一起，业务代码打包在一起
- 不同页面合并：  不同页面的js 分别打包
- 见机行事，随机应变

#### 如何进行文件合并

1. 使用在线网站进行压缩（废弃： 不符合现代化前端构建工具方案）
2. 使用node.js 工具实现文件合并： 比如webpack  glup 等

### <font color='red'> 掌握如何通过webpack 实现压缩和合并的方法  </font>

具体就是如何写webpack 配置了----见自己的webpack文档吧（填坑！！！！）



### 总结

- 发现 http 请求过程以及其中潜在的性能优化点
- 压缩与合并和混乱的基本使用





## 图片相关优化





